{"ast":null,"code":"import _objectSpread from\"C:/Users/Surya/OneDrive/Desktop/admitkard-assignment/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Surya/OneDrive/Desktop/admitkard-assignment/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useRef,useEffect}from\"react\";import{v4 as uuid}from\"uuid\";import{useNavigate}from\"react-router-dom\";import{useSelector,useDispatch}from\"react-redux\";import Cookies from\"js-cookie\";import axios from\"axios\";import OtpInput from\"react-otp-input\";import Snackbar from\"../snackbar/snackbar\";import{adduserLoginStatus}from\"../../actions\";import image from\"../../assets/undraw_confirmed_81ex.jpg\";import\"./styles.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SnackbarType={success:\"success\",fail:\"fail\"};var Otp=function Otp(){var dispatch=useDispatch();var mobileNumber=useSelector(function(state){return state.registrationReducer.mobileNumber;});// console.log(mobileNumber.number);\nvar navigate=useNavigate();var snackbarRef=useRef(null);var otp=localStorage.getItem(\"OTP\");var _useState=useState(),_useState2=_slicedToArray(_useState,2),enteredOTP=_useState2[0],setEnteredOtp=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),otpError=_useState4[0],setOTPerror=_useState4[1];//console.log(enteredOTP);\nvar onResend=function onResend(){var apiUrl=\"http://localhost:3001/generate-otp\";var data={mobileNumber:mobileNumber};var headers={\"Content-Type\":\"application/json\"};axios.post(apiUrl,data,{headers:headers}).then(function(response){if(response.statusText===\"OK\"){otp=response.data.otp;// console.log(response.data);\n}snackbarRef.current.show();}).catch(function(error){console.error(\"Error:\",error.message);});};useEffect(function(){var timer=setTimeout(function(){if(snackbarRef.current){snackbarRef.current.show();}},2000);return function(){return clearTimeout(timer);};},[snackbarRef]);var onChangeNumber=function onChangeNumber(){navigate(\"/\");};var validateOTP=function validateOTP(){var apiUrl=\"http://localhost:3001/validate-otp\";var data={mobileNumber:\"\".concat(mobileNumber.number),enteredOTP:\"\".concat(enteredOTP)};var headers={\"Content-Type\":\"application/json\"};if(enteredOTP===\"\"){setOTPerror(\"Enter the otp\");}else{axios.post(apiUrl,data,{headers:headers}).then(function(response){setEnteredOtp(response.data.message);dispatch(adduserLoginStatus(true));Cookies.set(\"userToken\",uuid());navigate(\"/success\");}).catch(function(error){setOTPerror(\"Entered OTP is wrong\");});}};var handleChangeOtp=function handleChangeOtp(value){setEnteredOtp(value);setOTPerror(\"\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"otp-container\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(image),alt:\"logo\",className:\"logo\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"Please verify Mobile number\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"number-edit-container\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Please sign in to your account\",/*#__PURE__*/_jsx(\"span\",{children:\"+\"+mobileNumber.number})]}),/*#__PURE__*/_jsx(\"p\",{onClick:onChangeNumber,children:\"Change Phone Number\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"otp-input-container\",children:[/*#__PURE__*/_jsx(OtpInput,{value:enteredOTP,onChange:function onChange(value){return handleChangeOtp(value);},numInputs:4,renderSeparator:/*#__PURE__*/_jsx(\"span\",{style:{width:\"8px\"}}),renderInput:function renderInput(props){return/*#__PURE__*/_jsx(\"input\",_objectSpread({},props));},inputStyle:{border:\"solid #e5e5e5 1px\",borderRadius:\"8px\",width:\"48px\",height:\"48px\",fontSize:\"18px\",color:\"#333\",fontWeight:\"500\",caretColor:\"blue\",fontStyle:\"normal\",fontFamily:\"Work Sans\",boxShadow:\"6px 6px 5px 0px rgba(224,222,222,0.75)\",outlineColor:\"#80848c\"},focusStyle:{border:\"1px solid #637290\",outline:\"none\"}}),otpError&&/*#__PURE__*/_jsx(\"p\",{style:{color:\"red\"},children:otpError})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Didn\\u2019t receive the code?\",/*#__PURE__*/_jsx(\"span\",{onClick:onResend,children:\"Resend\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"submit-button\",onClick:validateOTP,children:\"Verify\"})]}),/*#__PURE__*/_jsx(Snackbar,{ref:snackbarRef,message:\"Your OTP is \".concat(otp),type:SnackbarType.success})]});};export default Otp;","map":{"version":3,"names":["React","useState","useRef","useEffect","v4","uuid","useNavigate","useSelector","useDispatch","Cookies","axios","OtpInput","Snackbar","adduserLoginStatus","image","jsx","_jsx","jsxs","_jsxs","SnackbarType","success","fail","Otp","dispatch","mobileNumber","state","registrationReducer","navigate","snackbarRef","otp","localStorage","getItem","_useState","_useState2","_slicedToArray","enteredOTP","setEnteredOtp","_useState3","_useState4","otpError","setOTPerror","onResend","apiUrl","data","headers","post","then","response","statusText","current","show","catch","error","console","message","timer","setTimeout","clearTimeout","onChangeNumber","validateOTP","concat","number","set","handleChangeOtp","value","className","children","src","alt","onClick","onChange","numInputs","renderSeparator","style","width","renderInput","props","_objectSpread","inputStyle","border","borderRadius","height","fontSize","color","fontWeight","caretColor","fontStyle","fontFamily","boxShadow","outlineColor","focusStyle","outline","ref","type"],"sources":["C:/Users/Surya/OneDrive/Desktop/admitkard-assignment/frontend/src/component/otp/otp.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\r\nimport { v4 as uuid } from \"uuid\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport Cookies from \"js-cookie\";\r\nimport axios from \"axios\";\r\nimport OtpInput from \"react-otp-input\";\r\nimport Snackbar from \"../snackbar/snackbar\";\r\nimport { adduserLoginStatus } from \"../../actions\";\r\n\r\nimport image from \"../../assets/undraw_confirmed_81ex.jpg\";\r\n\r\nimport \"./styles.scss\";\r\n\r\nconst SnackbarType = {\r\n  success: \"success\",\r\n  fail: \"fail\",\r\n};\r\n\r\nconst Otp = () => {\r\n  const dispatch = useDispatch();\r\n  const mobileNumber = useSelector(\r\n    (state) => state.registrationReducer.mobileNumber\r\n  );\r\n  // console.log(mobileNumber.number);\r\n  const navigate = useNavigate();\r\n  const snackbarRef = useRef(null);\r\n  let otp = localStorage.getItem(\"OTP\");\r\n\r\n  const [enteredOTP, setEnteredOtp] = useState();\r\n  const [otpError, setOTPerror] = useState(\"\");\r\n  //console.log(enteredOTP);\r\n\r\n  const onResend = () => {\r\n    const apiUrl = \"http://localhost:3001/generate-otp\";\r\n    const data = {\r\n      mobileNumber: mobileNumber,\r\n    };\r\n\r\n    const headers = {\r\n      \"Content-Type\": \"application/json\",\r\n    };\r\n    axios\r\n      .post(apiUrl, data, { headers: headers })\r\n      .then((response) => {\r\n        if (response.statusText === \"OK\") {\r\n          otp = response.data.otp;\r\n          // console.log(response.data);\r\n        }\r\n        snackbarRef.current.show();\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Error:\", error.message);\r\n  \r\n      });\r\n  };\r\n\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      if (snackbarRef.current) {\r\n        snackbarRef.current.show();\r\n      }\r\n    }, 2000);\r\n    return () => clearTimeout(timer);\r\n  }, [snackbarRef]);\r\n\r\n  const onChangeNumber = () => {\r\n    navigate(\"/\");\r\n  };\r\n\r\n  const validateOTP = () => {\r\n    const apiUrl = \"http://localhost:3001/validate-otp\";\r\n    const data = {\r\n      mobileNumber: `${mobileNumber.number}`,\r\n      enteredOTP: `${enteredOTP}`,\r\n    };\r\n\r\n    const headers = {\r\n      \"Content-Type\": \"application/json\",\r\n    };\r\n\r\n    if (enteredOTP === \"\") {\r\n      setOTPerror(\"Enter the otp\");\r\n    } else {\r\n      axios\r\n        .post(apiUrl, data, { headers: headers })\r\n        .then((response) => {\r\n          setEnteredOtp(response.data.message);\r\n          dispatch(adduserLoginStatus(true));\r\n          Cookies.set(\"userToken\", uuid());\r\n          navigate(\"/success\");\r\n        })\r\n        .catch((error) => {\r\n          setOTPerror(\"Entered OTP is wrong\");\r\n          \r\n        });\r\n    }\r\n  };\r\n\r\n  const handleChangeOtp = (value) => {\r\n    setEnteredOtp(value);\r\n    setOTPerror(\"\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"otp-container\">\r\n      <img src={`${image}`} alt=\"logo\" className=\"logo\" />\r\n      <h1>Please verify Mobile number</h1>\r\n      <div className=\"number-edit-container\">\r\n        <p>\r\n          Please sign in to your account<span>{\"+\" + mobileNumber.number}</span>\r\n        </p>\r\n        <p onClick={onChangeNumber}>Change Phone Number</p>\r\n      </div>\r\n      <div className=\"otp-input-container\">\r\n        <OtpInput\r\n          value={enteredOTP}\r\n          onChange={(value) => handleChangeOtp(value)}\r\n          numInputs={4}\r\n          renderSeparator={<span style={{ width: \"8px\" }}></span>}\r\n          renderInput={(props) => <input {...props} />}\r\n          inputStyle={{\r\n            border: \"solid #e5e5e5 1px\",\r\n            borderRadius: \"8px\",\r\n            width: \"48px\",\r\n            height: \"48px\",\r\n            fontSize: \"18px\",\r\n            color: \"#333\",\r\n            fontWeight: \"500\",\r\n            caretColor: \"blue\",\r\n            fontStyle: \"normal\",\r\n            fontFamily: \"Work Sans\",\r\n            boxShadow: \"6px 6px 5px 0px rgba(224,222,222,0.75)\",\r\n            outlineColor: \"#80848c\",\r\n          }}\r\n          focusStyle={{\r\n            border: \"1px solid #637290\",\r\n            outline: \"none\",\r\n          }}\r\n        />\r\n        {otpError && <p style={{ color: \"red\" }}>{otpError}</p>}\r\n      </div>\r\n      <div>\r\n        <p>\r\n          Didn’t receive the code?<span onClick={onResend}>Resend</span>\r\n        </p>\r\n        <button className=\"submit-button\" onClick={validateOTP}>\r\n          Verify\r\n        </button>\r\n      </div>\r\n      <Snackbar\r\n        ref={snackbarRef}\r\n        message={`Your OTP is ${otp}`}\r\n        type={SnackbarType.success}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Otp;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}